<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Controle Financeiro</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #111827;
      color: #f3f4f6;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 2rem;
    }

    .container {
      background: #1f2937;
      border-radius: 16px;
      padding: 2rem;
      width: 100%;
      max-width: 480px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    h1 {
      text-align: center;
      margin-bottom: 1rem;
      font-size: 1.8rem;
      color: #f9fafb;
    }

    .input-group {
      margin-bottom: 1rem;
    }

    .input-group input {
      width: 100%;
      padding: 0.75rem;
      border-radius: 8px;
      border: none;
      margin-bottom: 0.5rem;
      background-color: #374151;
      color: #fff;
    }

    button {
      width: 100%;
      padding: 0.75rem;
      border: none;
      border-radius: 8px;
      background-color: #06b6d4;
      color: white;
      font-size: 1rem;
      cursor: pointer;
    }

    button:hover {
      background-color: #0891b2;
    }

    .tabs {
      display: flex;
      justify-content: space-around;
      margin-top: 1rem;
      margin-bottom: 1rem;
    }

    .tabs button {
      flex: 1;
      background: none;
      border: none;
      color: #9ca3af;
      padding: 0.5rem;
      cursor: pointer;
    }

    .tabs button.active {
      color: #f3f4f6;
      border-bottom: 2px solid #06b6d4;
    }

    .summary {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1rem;
    }

    .summary div {
      text-align: center;
    }

    .green {
      color: #10b981;
    }

    .red {
      color: #ef4444;
    }

    ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    li {
      background-color: #374151;
      border-radius: 8px;
      padding: 0.75rem;
      margin-bottom: 0.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    li .desc {
      display: flex;
      gap: 0.5rem;
    }

    li button {
      background: none;
      border: none;
      color: #9ca3af;
      cursor: pointer;
    }

    canvas {
      margin-top: 2rem;
    }

  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸ’¸ Controle Financeiro</h1>
    <div class="input-group">
      <input id="desc" placeholder="DescriÃ§Ã£o (ex: SalÃ¡rio ou Mercado)" />
      <input id="amount" placeholder="Valor (ex: 2.756,66)" />
    </div>
    <button onclick="addTransaction()">Adicionar</button>

    <div class="tabs">
      <button onclick="changeTab('todos')" id="tab-todos" class="active">Todos</button>
      <button onclick="changeTab('entrada')" id="tab-entrada">Entradas</button>
      <button onclick="changeTab('saida')" id="tab-saida">SaÃ­das</button>
    </div>

    <div class="summary">
      <div><strong>Saldo</strong><br><span id="saldo">R$ 0,00</span></div>
      <div><strong class="green">Receitas</strong><br><span id="entradas">R$ 0,00</span></div>
      <div><strong class="red">Despesas</strong><br><span id="saidas">R$ 0,00</span></div>
    </div>

    <ul id="lista-transacoes"></ul>

    <canvas id="grafico" height="200"></canvas>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    let transactions = JSON.parse(localStorage.getItem('transacoes')) || [];
    let currentTab = 'todos';

    function formatar(valor) {
      return valor.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
    }

    function parseValor(valorStr) {
      return parseFloat(valorStr.replace(/\./g, '').replace(',', '.'));
    }

    function salvar() {
      localStorage.setItem('transacoes', JSON.stringify(transactions));
    }

    function addTransaction() {
      const desc = document.getElementById('desc').value.trim();
      const valorStr = document.getElementById('amount').value.trim();
      if (!desc || !valorStr) return alert('Preencha todos os campos.');

      const valor = parseValor(valorStr);
      if (isNaN(valor)) return alert('Valor invÃ¡lido.');

      transactions.push({ desc, valor });
      salvar();
      document.getElementById('desc').value = '';
      document.getElementById('amount').value = '';
      atualizar();
    }

    function remover(index) {
      transactions.splice(index, 1);
      salvar();
      atualizar();
    }

    function changeTab(tab) {
      currentTab = tab;
      document.querySelectorAll('.tabs button').forEach(btn => btn.classList.remove('active'));
      document.getElementById(`tab-${tab}`).classList.add('active');
      atualizar();
    }

    function atualizar() {
      const lista = document.getElementById('lista-transacoes');
      lista.innerHTML = '';

      let saldo = 0;
      let entradas = 0;
      let saidas = 0;

      transactions.forEach((t, i) => {
        if (currentTab === 'entrada' && t.valor < 0) return;
        if (currentTab === 'saida' && t.valor >= 0) return;

        const li = document.createElement('li');
        const spanDesc = document.createElement('span');
        spanDesc.className = 'desc';
        spanDesc.innerHTML = `${t.valor >= 0 ? 'ðŸ’°' : 'ðŸ›’'} ${t.desc}`;

        const spanValor = document.createElement('span');
        spanValor.innerHTML = `<strong class="${t.valor >= 0 ? 'green' : 'red'}">${formatar(t.valor)}</strong>`;

        const btn = document.createElement('button');
        btn.textContent = 'âœ•';
        btn.onclick = () => remover(i);

        li.appendChild(spanDesc);
        li.appendChild(spanValor);
        li.appendChild(btn);
        lista.appendChild(li);

        saldo += t.valor;
        if (t.valor >= 0) entradas += t.valor;
        else saidas += t.valor;
      });

      document.getElementById('saldo').textContent = formatar(saldo);
      document.getElementById('entradas').textContent = formatar(entradas);
      document.getElementById('saidas').textContent = formatar(Math.abs(saidas));

      gerarGrafico(entradas, Math.abs(saidas));
    }

    let grafico;

    function gerarGrafico(receitas, despesas) {
      const ctx = document.getElementById('grafico').getContext('2d');
      if (grafico) grafico.destroy();

      grafico = new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: ['Receitas', 'Despesas'],
          datasets: [{
            data: [receitas, despesas],
            backgroundColor: ['#10b981', '#ef4444']
          }]
        },
        options: {
          plugins: {
            legend: { position: 'bottom', labels: { color: '#fff' } }
          }
        }
      });
    }

    atualizar();
  </script>
</body>
</html>
